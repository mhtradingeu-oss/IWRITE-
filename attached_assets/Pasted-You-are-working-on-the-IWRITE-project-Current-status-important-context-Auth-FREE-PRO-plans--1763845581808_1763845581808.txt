You are working on the IWRITE project.

Current status (important context):

- Auth, FREE/PRO plans, daily limits, and admin role are already implemented.
- There is an Admin API (`server/adminRoutes.ts`) with endpoints like:
  - GET /api/admin/users
  - PUT /api/admin/users/:id/plan
  - PUT /api/admin/users/:id/reset-usage
  - GET /api/admin/stats
- The Admin page (`client/src/pages/Admin.tsx`) already exists but should be upgraded into a **full management console**.
- AI integration for content generation already exists elsewhere in the app (AI Writer, Songwriter).

Your task in THIS TURN is to focus ONLY on the **Admin experience** and:

1) Turn the Admin page into a complete dashboard for managing users and monitoring the app.
2) Add an “Admin AI Assistant” panel that uses the existing AI integration to help interpret stats and suggest actions.
3) Verify behavior with real test accounts (FREE + PRO/admin).
4) Do NOT break any existing routes, auth, or plan logic.

⚠️ DO NOT:

- Change API routes or database schema.
- Rename env vars (FREE_DAILY_LIMIT, ADMIN_EMAIL, STRIPE_*, etc.).
- Alter auth or security behavior.
- Move QueryClientProvider.

You MAY:

- Extend `adminRoutes.ts` slightly (if needed) using the same patterns already used.
- Heavily improve the Admin page UI & client-side logic.
- Add client-side helper functions and components.
- Call existing AI endpoints from the Admin page.

==================================================
PART 1 – ADMIN ROUTES CONFIRMATION (BACKEND SURVEY ONLY)
==================================================

1) Open `server/adminRoutes.ts` and confirm what is already available:
   - `GET /api/admin/users` → list of users, with fields like id, email, role, plan, createdAt, usage data.
   - `PUT /api/admin/users/:id/plan` → change user plan.
   - `PUT /api/admin/users/:id/reset-usage` → reset usage counters.
   - `GET /api/admin/stats` → summary numbers (total users, total free, total pro, daily usage, etc.).

2) If some of the above are missing but trivial to add using existing schema:
   - You MAY add them but only following the existing patterns:
     - Use the same `requireAdmin` middleware.
     - Return JSON with simple shape, no breaking changes.

3) Do NOT add complex new features (no new tables, no logs DB, etc.). Focus on using what already exists.

==================================================
PART 2 – REDESIGN THE ADMIN PAGE LAYOUT
==================================================

Open `client/src/pages/Admin.tsx`. Transform it into a professional admin console with:

1) Top-level layout:

- Title: “Admin Console” (with i18n keys for EN/DE/AR).
- Short description: “Manage users, plans, usage limits, and monitor the IWRITE workspace.”
- Use the existing design system (cards, grids, dark theme).

2) Tabs or sections:

- Suggested structure:
  - **Overview**
  - **Users**
  - **Usage & Limits**
  - **Admin AI Assistant**

You can implement as:

- Tabs
- Or left-side sub-navigation inside the Admin page
- Or stacked sections on a single scrollable page

As long as it’s clear and not cluttered.

==================================================
PART 3 – OVERVIEW SECTION (STATS & CARDS)
==================================================

In the **Overview** section:

1) Fetch stats using `GET /api/admin/stats` or a combination of admin/dashboard APIs.

2) Show key metrics as cards:

- Total Users
- FREE Users vs PRO Users
- Active users in the last N days (if the stats endpoint provides this; otherwise omit).
- Total documents or AI generations (if available).
- Daily usage vs FREE limit (if available).

3) Visuals:

- Use cards with icon + big number + label.
- Possibly a small usage chart (e.g., daily generations over the last 7 days) if a simple stats endpoint is available.
- If no time-series data is available, stick to simple cards and a small table.

4) Loading & error states:

- While loading stats, show skeletons/spinners.
- On error, show a non-intrusive error banner that suggests reloading.

==================================================
PART 4 – USERS SECTION (MANAGEMENT TOOLS)
==================================================

In the **Users** section:

1) Users table:

- Fetch data from `GET /api/admin/users`.
- Columns:
  - Email
  - Role (user/admin)
  - Plan (FREE / PRO_*)
  - Created At
  - Today’s usage vs limit (if data exists)
- Add:
  - Search by email
  - Filter by plan (All / FREE / PRO)
  - Filter by role (All / Admin / User)

2) Per-user actions:

Using the existing admin endpoints:

- Change Plan:
  - Add a dropdown or button to set plan (FREE, PRO_MONTHLY, PRO_YEARLY).
  - On change:
    - Call PUT `/api/admin/users/:id/plan`.
    - Show success/error toast.
    - Refetch the table row or list.

- Reset Usage:
  - Button “Reset daily usage” → calls PUT `/api/admin/users/:id/reset-usage`.
  - Show confirmation modal before calling.

3) UX details:

- Show badges for plan:
  - FREE: gray badge
  - PRO: colored badge (e.g., blue) with label “PRO”
- Show badge for Admin:
  - If role=admin, show “Admin” pill.
- Use pagination or lazy loading if the list is large, but keep it simple.

==================================================
PART 5 – USAGE & LIMITS SECTION
==================================================

In **Usage & Limits** (could be merged with Overview if simpler):

1) Use stats endpoint or aggregated data to show:

- Daily total AI generations (today).
- Breakdown by FREE vs PRO.
- Top N users by usage (if data is available from `/api/admin/users`).

2) Present in:

- Table or simple chart (bar chart with existing chart library – if already used elsewhere).
- Cards summarizing limit usage:
  - “Free plan daily limit: {FREE_DAILY_LIMIT} generations/day”
  - “Total FREE usage today: X of {FREE_DAILY_LIMIT × freeUsersCount} potential generation slots.”

3) If certain data is not available from backend:

- Do not invent new endpoints; instead:
  - Show what can be computed from available fields.
  - Omit deep analytics.

==================================================
PART 6 – ADMIN AI ASSISTANT PANEL
==================================================

We already have AI integration for generation (e.g., server/ai.ts and existing endpoints used by AI Writer).

Use that to build an **Admin AI Assistant** to help interpret stats and suggest actions.

1) UI:

- Create a dedicated panel/section on the Admin page:
  - Title: “Admin AI Assistant”
  - Description: “Get AI-powered insights and suggestions based on current usage and user plans.”

- Components:
  - A textarea or prompt input where the admin can ask:
    - “Summarize today’s usage.”
    - “Which users should I consider upgrading?”
    - “Are there any anomalies in usage?”
  - Predefined buttons like:
    - “Summarize user activity”
    - “Suggest plan optimizations”
    - “Explain current FREE limit usage”

2) Backend/API:

- Reuse existing AI endpoints (e.g., the same route the AI Writer uses) or a generic AI endpoint already implemented.
- For each request:
  - Gather current stats client-side:
    - data from `/api/admin/stats`
    - possibly aggregated info from `/api/admin/users`
  - Build a context string (prompt) on the frontend including these stats.
  - Send to the AI endpoint with a system prompt like:

    “You are an admin assistant for the IWRITE app. Based on the following stats, provide a short analysis and concrete suggestions…”

- Return the AI response and display it in the Admin page as a chat-style panel or answer box.

3) Constraints:

- Do not create a new large backend AI system. Use the existing AI integration pattern.
- Make sure errors from AI calls are handled (loading spinner, error message, retry button).

==================================================
PART 7 – ACCESS CONTROL & SAFETY CHECKS
==================================================

1) AppSidebar / navigation:

- Ensure the “Admin” item in the sidebar only shows for users with `role === "admin"` (already implemented but re-check).
- If a non-admin visits `/admin`, show:
  - A friendly “Access denied – Admin only” message and/or redirect to `/dashboard`.

2) Security:

- All `/api/admin/*` routes must be guarded by admi*
