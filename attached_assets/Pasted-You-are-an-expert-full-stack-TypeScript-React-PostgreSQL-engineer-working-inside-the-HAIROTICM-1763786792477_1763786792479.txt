You are an expert full-stack TypeScript + React + PostgreSQL engineer working inside the **HAIROTICMEN Writer** Replit workspace.

üéØ GLOBAL GOAL
Your mission now is to **finalize this project for production**:
- Verify that all core features are implemented and working.
- Fix any remaining runtime/build issues.
- Polish UX and error handling.
- Prepare the codebase, configuration, and documentation so the app is ready to be used and published.

Do NOT start coding blindly. First, analyze, then plan, then implement.

üì¶ PROJECT CONTEXT (HAIROTICMEN Writer)
High-level features that should be ready:

1) Document & File Management
   - Upload & manage files: PDF, DOCX, CSV, XLSX, images (up to ~50MB).
   - Organize documents in projects/folders.
   - Support for AR / EN / DE content.

2) Templates & Brand
   - Template library with logo/header/footer/brand colors.
   - Ability to apply templates to generated documents (especially HAIROTICMEN templates).

3) AI Writer / Document Generation
   - **AI Writer section/page** with:
     - Prompt box
     - Task presets (new doc, rewrite, summarize, expand, translate, fix style‚Ä¶)
     - Controls for:
       - document type
       - language (AR/EN/DE)
       - tone/formality
       - length
       - template choice
       - selected source documents/topics
     - Main editor showing the AI-generated draft.
   - Ability to:
     - create a new draft from sources
     - improve / rewrite the current draft
     - work with selected text (improve / shorten / expand).

4) Topic Intelligence
   - Backend already exists for:
     - splitting documents into passages
     - keyword search
     - basic entity extraction (numbers, dates, ISO codes‚Ä¶)
   - UI should allow:
     - searching across documents by keyword
     - viewing passages with highlighted matches
     - seeing which docs/topics are linked.

5) QA Checks
   - Trigger QA on a given document/draft.
   - Checks for:
     - medical/sensitive claims
     - disclaimers
     - numeric consistency
     - product codes
   - Show results in a clear UI with severity (green/yellow/red) and suggested fixes.

6) Export
   - Export to:
     - Markdown
     - DOCX
     - styled HTML (and ideally a clean path to real PDF export, even if minimal).
   - The path to implement real PDF export (e.g. via Puppeteer or pdf-lib) should at least be prepared or stubbed with clear TODOs if full integration is not possible now.

üß© STEP 1 ‚Äî ANALYZE & REPORT
1. Scan the repository:
   - Read `replit.md` or any root docs.
   - Examine:
     - server/backend (routes, controllers, services)
     - frontend (React/Next/Vite components, layouts, pages)
     - database schema (migrations, Prisma/ORM models if any)
     - Topic Intelligence service
     - QA service
     - existing AI endpoints.
2. Run the dev server and tests (if configured) inside Replit.
3. Identify and list:
   - any failing builds or runtime errors,
   - any ‚ÄúTODO‚Äù or ‚ÄúFIXME‚Äù markers that affect production,
   - missing or partially implemented features related to the list above.

Produce a short, structured diagnostic first:
- ‚ÄúBackend status: ‚Ä¶‚Äù
- ‚ÄúFrontend status: ‚Ä¶‚Äù
- ‚ÄúTopic Intelligence status: ‚Ä¶‚Äù
- ‚ÄúAI Writer UI status: ‚Ä¶‚Äù
- ‚ÄúQA status: ‚Ä¶‚Äù
- ‚ÄúExport status: ‚Ä¶‚Äù
- ‚ÄúDeployment/config status: ‚Ä¶‚Äù

üß© STEP 2 ‚Äî PLAN FINALIZATION
Based on your analysis, propose a **concrete, prioritized plan** to reach a production-ready state, for example:

1) Fix build/runtime issues.
2) Complete AI Writer section + integration.
3) Ensure Topic Intelligence search UI is usable.
4) Wire QA into AI Writer / document view.
5) Finalize export flows.
6) Polish UX (loading, errors, i18n, RTL).
7) Add final documentation and configuration.

Keep this plan short but actionable.

üß© STEP 3 ‚Äî IMPLEMENT & FIX
Then execute the plan in small steps:

For each step:
1. Briefly say what you are about to do.
2. Modify or create the necessary files, reusing existing patterns and components.
3. Keep TypeScript types strict; avoid `any` unless absolutely necessary.
4. Respect:
   - current design system (Fluent-like productivity UI),
   - AR/EN/DE support with proper RTL handling,
   - performance and memory limits (no heavy new libraries without strong reason).
5. After each significant change:
   - Run the relevant build/dev/test command.
   - Fix any errors you see.

Key points to verify/implement:

- AI Writer page:
  - Has prompt box, presets, controls, sources (documents/topics), template selector, and QA button.
  - Integrates with backend AI endpoints for:
    - new draft generation,
    - improve/shorten/expand,
    - optional translation.
- Topic Intelligence:
  - Minimal but working UI for searching and inspecting passages across docs.
- QA:
  - Button in AI Writer / document view to run QA.
  - Display list of issues clearly.
- Export:
  - Ensure export to MD/DOCX/HTML works without errors.
  - If real PDF is integrated, test it; if not, create a clear TODO note and keep export pipeline stable.

üß© STEP 4 ‚Äî PRODUCTION READINESS CHECKLIST
Before finishing, prepare and, if needed, create/update the following files:

1) **README.md**
   - What the project is (HAIROTICMEN Writer).
   - Main features.
   - Tech stack.
   - How to run in development.
   - How to build for production.
   - How to configure environment variables (API keys, DB, etc.).
   - Known limitations (e.g. memory, PDF export details).

2) **Deployment / Production Notes**
   - Either in README or a separate `DEPLOYMENT.md`:
     - Environment variables required.
     - Database migration steps.
     - Any background jobs / cron tasks (if needed).
     - How to run the app in a production-like environment (Replit, Docker, or other).

3) **replit config**
   - Confirm `run` / `start` command is correct.
   - Confirm build step if needed.
   - Ensure no sensitive secrets are hardcoded.

4) **Basic Health Checks**
   - Make sure the home page loads without errors.
   - File upload works for at least a small set of test files (PDF/DOCX/CSV/XLSX).
   - AI Writer opens and can perform at least:
     - simple text generation,
     - simple rewrite.
   - Topic search returns some results (or fails gracefully with an empty state).
   - QA can run on a sample document (or at minimum, the UI doesn't crash).

üß© STEP 5 ‚Äî FINAL SUMMARY & FILES
At the end, provide:

1. A concise summary of:
   - What you changed.
   - Which features are now fully working.
   - Any remaining known limitations or future enhancements.

2. A list of key files for the owner to review, for example:
   - `src/.../AiWriterPage.tsx`  (or whatever file name you used)
   - `src/.../topic-intelligence/*`
   - `src/.../qa/*`
   - `README.md`
   - `DEPLOYMENT.md` (if created)
   - any new config/migration files.

3. Clear instructions:
   - ‚ÄúTo run locally / in Replit do: ‚Ä¶‚Äù
   - ‚ÄúTo build and prepare for production do: ‚Ä¶‚Äù

GENERAL CODING RULES
- Keep changes minimal but high-impact.
- Do not introduce breaking changes to existing APIs unless absolutely required, and document them clearly.
- Prioritize stability and clarity over fancy features.
- All user-facing strings should remain compatible with the existing i18n / language system (AR/EN/DE).

Your final goal:  
**Make HAIROTICMEN Writer stable, clean, and ready for real-world use and publication, with clear docs and no obvious runtime errors.**
